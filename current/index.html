<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="PEP Engine Design Document for the Common Architecture">
<meta name="keywords" content="common architecture design">
<meta name="author" content="TVUK System Team">
<title>PEP Engine Design Document: EOEPCA.SDD.xxx</title>
<link rel="stylesheet" href="stylesheets/eoepca.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>PEP Engine Design Document: EOEPCA.SDD.xxx</h1>
<div class="details">
<span id="author" class="author">TVUK System Team</span><br>
<span id="email" class="email">&lt;<a href="mailto:Eoepca.SystemTeam@telespazio.com">Eoepca.SystemTeam@telespazio.com</a>&gt;</span><br>
<span id="revnumber">version 0.1,</span>
<span id="revdate">dd/mm/yyyy</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">PEP Engine Design Document</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_purpose_and_scope">1.1. Purpose and Scope</a></li>
<li><a href="#_structure_of_the_document">1.2. Structure of the Document</a></li>
<li><a href="#_reference_documents">1.3. Reference Documents</a></li>
<li><a href="#_terminology">1.4. Terminology</a></li>
<li><a href="#_glossary">1.5. Glossary</a></li>
</ul>
</li>
<li><a href="#mainOverview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_building_block_overview">2.1. Building Block Overview</a>
<ul class="sectlevel3">
<li><a href="#_initialization_flow">2.1.1. Initialization flow</a></li>
</ul>
</li>
<li><a href="#_external_interfaces">2.2. External Interfaces</a>
<ul class="sectlevel3">
<li><a href="#_exposed_interfaces">2.2.1. Exposed Interfaces</a>
<ul class="sectlevel4">
<li><a href="#_https_reverse_proxy_listener">2.2.1.1. HTTP(S) (Reverse Proxy Listener)</a></li>
<li><a href="#_https_to_resource_server">2.2.1.2. HTTP(S) (to Resource Server)</a></li>
</ul>
</li>
<li><a href="#_consumed_interfaces">2.2.2. Consumed Interfaces</a>
<ul class="sectlevel4">
<li><a href="#_uma_to_login_service">2.2.2.1. UMA (to Login Service)</a></li>
<li><a href="#_oidc_to_login_service">2.2.2.2. OIDC (to Login Service)</a></li>
<li><a href="#_scim_to_login_service">2.2.2.3. SCIM (to Login Service)</a></li>
<li><a href="#_resource_api">2.2.2.4. Resource API</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_required_resources">2.3. Required resources</a>
<ul class="sectlevel3">
<li><a href="#_software">2.3.1. Software</a></li>
</ul>
</li>
<li><a href="#_static_architecture">2.4. Static Architecture</a></li>
<li><a href="#_use_cases">2.5. Use cases</a>
<ul class="sectlevel3">
<li><a href="#_self_authentication_registration">2.5.1. Self Authentication &amp; Registration</a></li>
<li><a href="#_ticket_generation">2.5.2. Ticket generation</a></li>
<li><a href="#_resource_protection_rpt_validation">2.5.3. Resource protection &amp; RPT validation</a></li>
<li><a href="#_request_forwarding_with_jwt_header">2.5.4. Request Forwarding with JWT header</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mainComponents">3. Design</a>
<ul class="sectlevel2">
<li><a href="#_building_block_design">3.1. Building Block Design</a></li>
<li><a href="#_reverse_proxy_service">3.2. Reverse Proxy Service</a>
<ul class="sectlevel3">
<li><a href="#_overview_and_purpose">3.2.1. Overview and Purpose</a></li>
<li><a href="#_software_reuse_and_dependencies">3.2.2. Software Reuse and Dependencies</a></li>
<li><a href="#_interfaces">3.2.3. Interfaces</a></li>
<li><a href="#_data">3.2.4. Data</a>
<ul class="sectlevel4">
<li><a href="#_configuration">3.2.4.1. Configuration</a></li>
<li><a href="#_data_flow">3.2.4.2. Data flow</a></li>
</ul>
</li>
<li><a href="#_extensibility">3.2.5. Extensibility</a></li>
<li><a href="#_applicable_resources">3.2.6. Applicable Resources</a></li>
</ul>
</li>
<li><a href="#_resource_repository">3.3. Resource Repository</a>
<ul class="sectlevel3">
<li><a href="#_overview_and_purpose_2">3.3.1. Overview and Purpose</a></li>
<li><a href="#_data_flow_2">3.3.2. Data flow</a></li>
<li><a href="#_applicable_resources_2">3.3.3. Applicable Resources</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>EO Exploitation Platform Common Architecture<br>
<em>PEP Engine Design Document</em><br>
EOEPCA.SDD.xxx</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>COMMENTS and ISSUES</strong><br>
If you would like to raise comments or issues on this document, please do so by raising an Issue at the following URL <a href="https://github.com/EOEPCA/um-pep-engine/issues" class="bare">https://github.com/EOEPCA/um-pep-engine/issues</a>.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>PDF</strong><br>
This document is available in PDF format <a href="EOEPCA-um-pep-engine.pdf" target="_blank" rel="noopener">here</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>EUROPEAN SPACE AGENCY CONTRACT REPORT</strong><br>
The work described in this report was done under ESA contract. Responsibility for the contents resides in the author or organisation that prepared it.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>TELESPAZIO VEGA UK Ltd</strong><br>
350 Capability Green, Luton, Bedfordshire, LU1 3LU, United Kingdom.<br>
Tel: +44 (0)1582 399000<br>
<a href="http://telespazio-vega.com/">www.telespazio-vega.com</a></p></td>
</tr>
</tbody>
</table>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">AMENDMENT HISTORY</dt>
<dd>
<p>This document shall be amended by releasing a new edition of the document in its entirety.<br>
The Amendment Record Sheet below records the history and issue status of this document.</p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Amendment Record Sheet</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 25%;">
<col style="width: 62.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">ISSUE</th>
<th class="tableblock halign-center valign-top">DATE</th>
<th class="tableblock halign-left valign-top">REASON</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">0.1</p></th>
<td class="tableblock halign-center valign-top"><p class="tableblock">dd/mm/yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial in-progress draft</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<hr>
<div style="page-break-after: always;"></div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_and_scope">1.1. Purpose and Scope</h3>
<div class="paragraph">
<p>This document presents the PEP Engine Design for the Common Architecture.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structure_of_the_document">1.2. Structure of the Document</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Section 2 - <a href="#mainOverview">Overview</a></dt>
<dd>
<p>Provides an overview of the PEP Engine component, within the context of the wider Common Architecture design.</p>
</dd>
<dt class="hdlist1">Section 3 - <a href="#mainComponents">Design</a></dt>
<dd>
<p>Provides the design of the PEP Engine component.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_reference_documents">1.3. Reference Documents</h3>
<div class="paragraph">
<p>The following is a list of Reference Documents with a direct bearing on the content of this document.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 63.6363%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Document Details</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="EOEPCA-UC"></a>[EOEPCA-UC]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>EOEPCA - Use Case Analysis<br>
EOEPCA.TN.005<br>
<a href="https://eoepca.github.io/use-case-analysis" class="bare">https://eoepca.github.io/use-case-analysis</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1.0,<br>
02/08/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="EP-FM"></a>[EP-FM]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Exploitation Platform - Functional Model,<br>
ESA-EOPSDP-TN-17-050</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1.0,<br>
30/11/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TEP-OA"></a>[TEP-OA]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Thematic Exploitation Platform Open Architecture,<br>
EMSS-EOPS-TN-17-002</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Issue 1,<br>
12/12/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="WPS-T"></a>[WPS-T]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14: WPS-T Engineering Report,<br>
OGC 18-036r1,<br>
<a href="http://docs.opengeospatial.org/per/18-036r1.html" class="bare">http://docs.opengeospatial.org/per/18-036r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-036r1,<br>
07/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="WPS-REST-JSON"></a>[WPS-REST-JSON]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC WPS 2.0 REST/JSON Binding Extension, Draft,<br>
OGC 18-062,<br>
<a href="https://raw.githubusercontent.com/opengeospatial/wps-rest-binding/develop/docs/18-062.pdf" class="bare">https://raw.githubusercontent.com/opengeospatial/wps-rest-binding/develop/docs/18-062.pdf</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>1.0-draft</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="CWL"></a>[CWL]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Common Workflow Language Specifications,<br>
<a href="https://www.commonwl.org/v1.0/" class="bare">https://www.commonwl.org/v1.0/</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.2</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB13-AP"></a>[TB13-AP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-13, EP Application Package Engineering Report,<br>
OGC 17-023,<br>
<a href="http://docs.opengeospatial.org/per/17-023.html" class="bare">http://docs.opengeospatial.org/per/17-023.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-023,<br>
30/01/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB13-ADES"></a>[TB13-ADES]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-13, Application Deployment and Execution Service Engineering Report,<br>
OGC 17-024,<br>
<a href="http://docs.opengeospatial.org/per/17-024.html" class="bare">http://docs.opengeospatial.org/per/17-024.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-024,<br>
11/01/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB14-AP"></a>[TB14-AP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14, Application Package Engineering Report,<br>
OGC 18-049r1,<br>
<a href="http://docs.opengeospatial.org/per/18-049r1.html" class="bare">http://docs.opengeospatial.org/per/18-049r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-049r1,<br>
07/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TB14-ADES"></a>[TB14-ADES]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Testbed-14, ADES &amp; EMS Results and Best Practices Engineering Report,<br>
OGC 18-050r1, <a href="http://docs.opengeospatial.org/per/18-050r1.html" class="bare">http://docs.opengeospatial.org/per/18-050r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>18-050r1,<br>
08/02/2019</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OS-GEO-TIME"></a>[OS-GEO-TIME]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenSearch GEO: OpenSearch Geo and Time Extensions,<br>
OGC 10-032r8,<br>
<a href="http://www.opengeospatial.org/standards/opensearchgeo" class="bare">http://www.opengeospatial.org/standards/opensearchgeo</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>10-032r8,<br>
14/04/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OS-EO"></a>[OS-EO]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenSearch EO: OGC OpenSearch Extension for Earth Observation,<br>
OGC 13-026r9,<br>
<a href="http://docs.opengeospatial.org/is/13-026r8/13-026r8.html" class="bare">http://docs.opengeospatial.org/is/13-026r8/13-026r8.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>13-026r9,<br>
16/12/2016</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="GEOJSON-LD"></a>[GEOJSON-LD]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC EO Dataset Metadata GeoJSON(-LD) Encoding Standard,<br>
OGC 17-003r1/17-084</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-003r1/17-084</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="GEOJSON-LD-RESP"></a>[GEOJSON-LD-RESP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC OpenSearch-EO GeoJSON(-LD) Response Encoding Standard,<br>
OGC 17-047</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>17-047</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="PCI-DSS"></a>[PCI-DSS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The Payment Card Industry Data Security Standard,<br>
<a href="https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss" class="bare">https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v3.2.1</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="CEOS-OS-BP"></a>[CEOS-OS-BP]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>CEOS OpenSearch Best Practise,<br>
<a href="http://ceos.org/ourwork/workinggroups/wgiss/access/opensearch/" class="bare">http://ceos.org/ourwork/workinggroups/wgiss/access/opensearch/</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.2,<br>
13/06/2017</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OIDC"></a>[OIDC]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OpenID Connect Core 1.0,<br>
<a href="https://openid.net/specs/openid-connect-core-1_0.html" class="bare">https://openid.net/specs/openid-connect-core-1_0.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0,<br>
08/11/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-CSW"></a>[OGC-CSW]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Catalogue Services 3.0 Specification - HTTP Protocol Binding (Catalogue Services for the Web),<br>
OGC 12-176r7,<br>
<a href="http://docs.opengeospatial.org/is/12-176r7/12-176r7.html" class="bare">http://docs.opengeospatial.org/is/12-176r7/12-176r7.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v3.0,<br>
10/06/2016</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WMS"></a>[OGC-WMS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Map Server Implementation Specification,<br>
OGC 06-042,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=14416" class="bare">http://portal.opengeospatial.org/files/?artifact_id=14416</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.3.0,<br>
05/03/2006</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WMTS"></a>[OGC-WMTS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Map Tile Service Implementation Standard,<br>
OGC 07-057r7,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=35326" class="bare">http://portal.opengeospatial.org/files/?artifact_id=35326</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.0,<br>
06/04/2010</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WFS"></a>[OGC-WFS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Feature Service 2.0 Interface Standard – With Corrigendum,<br>
OGC 09-025r2,<br>
<a href="http://docs.opengeospatial.org/is/09-025r2/09-025r2.html" class="bare">http://docs.opengeospatial.org/is/09-025r2/09-025r2.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v2.0.2,<br>
10/07/2014</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WCS"></a>[OGC-WCS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OGC Web Coverage Service (WCS) 2.1 Interface Standard - Core,<br>
OGC 17-089r1,<br>
<a href="http://docs.opengeospatial.org/is/17-089r1/17-089r1.html" class="bare">http://docs.opengeospatial.org/is/17-089r1/17-089r1.html</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v2.1,<br>
16/08/2018</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="OGC-WCPS"></a>[OGC-WCPS]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Web Coverage Processing Service (WCPS) Language Interface Standard,<br>
OGC 08-068r2,<br>
<a href="http://portal.opengeospatial.org/files/?artifact_id=32319" class="bare">http://portal.opengeospatial.org/files/?artifact_id=32319</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>v1.0.0,<br>
25/03/2009</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="AWS-S3"></a>[AWS-S3]</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Amazon Simple Storage Service REST API,<br>
<a href="https://docs.aws.amazon.com/AmazonS3/latest/API" class="bare">https://docs.aws.amazon.com/AmazonS3/latest/API</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>API Version 2006-03-01</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_terminology">1.4. Terminology</h3>
<div class="paragraph">
<p>The following terms are used in the Master System Design.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User with administrative capability on the EP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A self-contained set of operations to be performed, typically to achieve a desired data manipulation. The algorithm must be implemented (codified) for deployment and execution on the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Analysis Result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Products</em> produced as output of an <em>Interactive Application</em> analysis session.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Analytics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of activities aimed to discover, interpret and communicate meaningful patters within the data. Analytics considered here are performed manually (or in a semi-automatic way) on-line with the aid of <em>Interactive Applications</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Artefact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The 'software' component that provides the execution unit of the <em>Application Package</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Deployment and Execution Service (ADES)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS-T (REST/JSON) service that incorporates the Docker execution engine, and is responsible for the execution of the processing service (as a WPS request) within the ‘target’ Exploitation Platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Descriptor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A file that provides the metadata part of the <em>Application Package</em>. Provides all the metadata required to accommodate the processor within the WPS service and make it available for execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Package</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A platform independent and self-contained representation of a software item, providing executable, metadata and dependencies such that it can be deployed to and executed within an Exploitation Platform. Comprises the <em>Application Descriptor</em> and the <em>Application Artefact</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bulk Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution of a <em>Processing Service</em> on large amounts of data specified by AOI and TOI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The codification of an algorithm performed with a given programming language - compiled to Software or directly executed (interpretted) within the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform on which execution occurs (this may differ from the Host or Home platform where federated processing is happening)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consumer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User accessing existing services/products within the EP. Consumers may be scientific/research or commercial, and may or may not be experts of the domain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Access Library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An abstraction of the interface to the data layer of the resource tier. The library provides bindings for common languages (including python, Javascript) and presents a common object model to the code.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The act of building new products/services/applications to be exposed within the platform and made available for users to conduct exploitation activities. Development may be performed inside or outside of the platform. If performed outside, an integration activity will be required to accommodate the developed service so that it is exposed within the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Discovery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User finds products/services of interest to them based upon search criteria.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The act to start a <em>Processing Service</em> or an <em>Interactive Application</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution Management Service (EMS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The EMS is responsible for the orchestration of workflows, including the possibility of steps running on other (remote) platforms, and the on-demand deployment of processors to local/remote ADES as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User developing and integrating added-value to the EP (Scientific Researcher or Service Developer)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Exploitation Tier represents the end-users who exploit the services of the platform to perform analysis, or using high-level applications built-in on top of the platform’s services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">External Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An application or script that is developed and executed outside of the Exploitation Platform, but is able to use the data/services of the EP via a programmatic interface (API).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An unregistered User or an unauthenticated Consumer with limited access to the EP&#8217;s services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform on which a User is based or from which an action was initiated by a User</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host Platform</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform through which a Resource has been published</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity Provider (IdP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The source for validating user identity in a federated identity system, (user authentication as a service).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A stand-alone application provided within the exploitation platform for on-line hosted processing. Provides an interactive interface through which the user is able to conduct their analysis of the data, producing <em>Analysis Results</em> as output. Interactive Applications include at least the following types: console application, web application (rich browser interface), remote desktop to a hosted VM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Console Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A simple <em>Interactive Application</em> for analysis in which a console interface to a platform-hosted terminal is provided to the user. The console interface can be provided through the user&#8217;s browser session or through a remote SSH connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Remote Desktop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An Interactive Application for analysis provided as a remote desktop session to an OS-session (or directly to a 'native' application) on the exploitation platform. The user will have access to a number of applications within the hosted OS. The remote desktop session is provided through the user’s web browser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interactive Web Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An Interactive Application for analysis provided as a rich user interface through the user&#8217;s web browser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key-Value Pair</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A key-value pair (KVP) is an abstract data type that includes a group of key identifiers and a set of associated values. Key-value pairs are frequently used in lookup tables, hash tables and configuration files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes (K8s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container orchestration system for automating application deployment, scaling and management.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An encapsulation of Authenticated Login provision within the Exploitation Platform context. The Login Service is an OpenID Connect Provider that is used purely for authentication. It acts as a Relying Party in flows with external IdPs to obtain access to the user&#8217;s identity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO Network of Resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The coordinated collection of European EO resources (platforms, data sources, etc.).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A computer data storage architecture that manages data as objects. Each object typically includes the data itself, a variable amount of metadata, and a globally unique identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-demand Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>Processing Service</em> whose execution is initiated directly by the user on an ad-hoc basis.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform (EP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An on-line collection of products, services and tools for exploitation of EO data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Platform Tier represents the Exploitation Platform and the services it offers to end-users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of pre-defined activities that interact to achieve a result. For the exploitation platform, comprises on-line processing to derive data products from input data, conducted by a hosted processing service execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing Result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Products</em> produced as output of a <em>Processing Service</em> execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-interactive data processing that has a well-defined set of input data types, input parameterisation, producing <em>Processing Results</em> with a well-defined output data type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Products</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO data (commercial and non-commercial) and Value-added products and made available through the EP. <em>It is assumed that the Hosting Environment for the EP makes available an existing supply of EO Data</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A entity, such as a Product, Processing Service or Interactive Application, which is of interest to a user, is indexed in a catalogue and can be returned as a single meaningful search result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource Tier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Resource Tier represents the hosting infrastructure and provides the EO data, storage and compute upon which the exploitation platform is deployed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable Research Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An encapsulation of some research/analysis that describes all aspects required to reproduce the analysis, including data used, processing performed etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scientific Researcher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert user with the objective to perform scientific research. Having minimal IT knowledge with no desire to acquire it, they want the effort for the translation of their algorithm into a service/product to be minimised by the platform.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Developer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expert user with the objective to provide a performing, stable and reliable service/product. Having deeper IT knowledge or a willingness to acquire it, they require deeper access to the platform IT functionalities for optimisation of their algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Software</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compilation of code into a binary program to be executed within the platform on-line computing environment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Systematic Processing Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>Processing Service</em> whose execution is initiated automatically (on behalf of a user), either according to a schedule (routine) or triggered by an event (e.g. arrival of new data).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terms &amp; Conditions (T&amp;Cs)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The obligations that the user agrees to abide by in regard of usage of products/services of the platform. T&amp;Cs are set by the provider of each product/service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional Web Processing Service (WPS-T)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional extension to WPS that allows adhoc deployment / undeployment of user-provided processors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An individual using the EP, of any type (Admin/Consumer/Expert/Guest)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value-added products</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Products generated from processing services of the EP (or external processing) and made available through the EP. This includes products uploaded to the EP by users and published for collaborative consumption</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Visualisation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To obtain a visual representation of any data/products held within the platform - presented to the user within their web browser session.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Service (WCS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides an open specification for sharing raster datasets on the web.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Processing Service (WCPS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that defines a protocol-independent language for the extraction, processing, and analysis of multi-dimentional coverages representing sensor, image, or statistics data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Feature Service (WFS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that makes geographic feature data (vector geospatial datasets) available on the web.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Service (WMS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides a simple HTTP interface for requesting geo-registered map images from one or more distributed geospatial databases.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Tile Service (WMTS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that provides a simple HTTP interface for requesting map tiles of spatially referenced data using the images with predefined content, extent, and resolution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Processing Services (WPS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC standard that defines how a client can request the execution of a process, and how the output from the process is handled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workspace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user-scoped 'container' in the EP, in which each user maintains their own links to resources (products and services) that have been collected by a user during their usage of the EP. The workspace acts as the hub for a user&#8217;s exploitation activities within the EP</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_glossary">1.5. Glossary</h3>
<div class="paragraph">
<p>The following acronyms and abbreviations have been used in this report.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 85.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AAI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication &amp; Authorization Infrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ABAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute Based Access Control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Deployment and Execution Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALFA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abbreviated Language For Authorization</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AOI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Area of Interest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Management System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CWL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Workflow Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Access Library</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execution Management Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Earth Observation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exploitation Platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FUSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filesystem in Userspace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GeoXACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Geo-specific extension to the XACML Policy Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity and Access Management</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IdP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaScript Object Notation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K8s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KVP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key-value Pair</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M2M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine-to-machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Geospatial Consortium</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processor Development Environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Decision Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Enforcement Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy Information Point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RBAC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role Based Access Control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Representational State Transfer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Shell</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time of Interest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UMA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User-Managed Access</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual Network Computing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Coverage Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WFS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Feature Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WMTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Map Tile Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPS-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transactional Web Processing Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eXtensible Access Control Markup Language</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mainOverview">2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_building_block_overview">2.1. Building Block Overview</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>High-Level Description of the Building Block</p>
</li>
<li>
<p>Context within EOEPCA</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main functionality of the PEP is to be able to stand between a client and the client&#8217;s desired resource. By creating this setup, where only the PEP is visible to an external request, we effectively secure whatever is behind the PEP. The PEP will enforce any policy for a resource configured in the Authorization Server, following the UMA 2.0 standard.</p>
</div>
<div class="paragraph">
<p>When launched, the PEP will answer to all requests that start with the configured path. These answers will come in the form of UMA tickets (if there are no RPT provided, or an invalid one is used).<br>
In case the request is accompained by a header using a valid RPT in the format <code>Authorization: Bearer &lt;valid_RPT&gt;</code>, the PEP will make a request to the resource server, for the resource located exactly at the path requested (minus the configured at config), and return the resource&#8217;s server answer.</p>
</div>
<div class="paragraph">
<p>Examples follow, assuming the following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>path configured for the reverse proxy is "/pep"</p>
</li>
<li>
<p>the PEP is at pep.domain.com/pep</p>
</li>
<li>
<p>Resource server is at remote.server.com</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Token</th>
<th class="tableblock halign-left valign-top">Request to PEP</th>
<th class="tableblock halign-left valign-top">PEP Action</th>
<th class="tableblock halign-left valign-top">PEP answer</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (request does not get to PEP endpoint)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (the PEP doesn&#8217;t see this request)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/thing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate ticket for "/thing"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401 + ticket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid RPT for "/thing"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/thing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request to remote.server.com/thing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contents of remote.server.com/thing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid RPT for "/thing"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/different</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate ticket for "/different"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401 + ticket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INVALID RPT for "/thing"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/thing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate ticket for "/thing"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401 + ticket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No RPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/thing/with/large/path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate ticket for "/thing/with/large/path"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">401 + ticket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid RPT for "/thing/with/large/path"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pep.domain.com/pep/thing/with/large/path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request to remote.server.com/thing/with/large/path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contents of remote.server.com/thing/with/large/path</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To further clarify the flow the PEP uses, you can also take a look at the Data Flow in section <a href="#_data_flow">Data flow</a></p>
</div>
<div class="sect3">
<h4 id="_initialization_flow">2.1.1. Initialization flow</h4>
<div class="imageblock text-left">
<div class="content">
<img src="./images/init_flow.png" alt="init flow">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_external_interfaces">2.2. External Interfaces</h3>
<div class="sect3">
<h4 id="_exposed_interfaces">2.2.1. Exposed Interfaces</h4>
<div class="sect4">
<h5 id="_https_reverse_proxy_listener">2.2.1.1. HTTP(S) (Reverse Proxy Listener)</h5>
<div class="paragraph">
<p>An HTTP listener, which can be configured through the config file.<br>
This is the only input interface to interact directly with the PEP from outside, and is managed by the reverse proxy.</p>
</div>
<div class="paragraph">
<p>The default listener for this interface is <code>/pep/&lt;path-to-resource&gt;</code>.</p>
</div>
<div class="paragraph">
<p>This interface will parse the path and the headers in order to assert authentication and authorization of the client requesting the resource.</p>
</div>
</div>
<div class="sect4">
<h5 id="_https_to_resource_server">2.2.1.2. HTTP(S) (to Resource Server)</h5>
<div class="paragraph">
<p>The PEP will contact via HTTP with the configured Resource Server whenever a valid request with a valid RPT is done, or whenever RPT is not needed to access the resource.</p>
</div>
<div class="paragraph">
<p>The PEP will make a request to the RS, and will return the answer verbatim to the client that requested it, effectively acting like a transparent proxy from the client&#8217;s point of view. This allows the mentioned desired behaviour of being able to protect anything just placing the PEP "in front of" the resource to protect.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_consumed_interfaces">2.2.2. Consumed Interfaces</h4>
<div class="sect4">
<h5 id="_uma_to_login_service">2.2.2.1. UMA (to Login Service)</h5>
<div class="paragraph">
<p>The PEP will make the requests needed to handle the resources, along with the necessary requests to create tickets and check the validity of RPTs.</p>
</div>
<div class="paragraph">
<p>The endpoints used for UMA are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource registration: /oxauth/restv1/host/rsrc/resource_set/&lt;resource-id&gt;</p>
</li>
<li>
<p>Permission: /oxauth/restv1/host/rsrc_pr</p>
</li>
<li>
<p>Introspection: /oxauth/restv1/rpt/status</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_oidc_to_login_service">2.2.2.2. OIDC (to Login Service)</h5>
<div class="paragraph">
<p>The PEP uses the OIDC protocol in order to authenticate itself as a valid UMA client, and uses this OIDC client in all UMA-related queries.</p>
</div>
<div class="paragraph">
<p>These queries are done against the Login Service, and the endpoints used are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Token: /oxauth/restv1/token</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_scim_to_login_service">2.2.2.3. SCIM (to Login Service)</h5>
<div class="paragraph">
<p>The PEP has the capability to auto-register itself as a client if there is no client pre-configured from previous starts or previous configuration.</p>
</div>
<div class="paragraph">
<p>In order to do this, it utilizes the SCIM protocol, and queries the Login Service.</p>
</div>
<div class="paragraph">
<p>The endpoints used for SCIM are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User: /restv1/scim/v2/Users</p>
</li>
<li>
<p>Token: /oxauth/restv1/token</p>
</li>
<li>
<p>Register: /oxauth/restv1/register</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_resource_api">2.2.2.4. Resource API</h5>
<div class="paragraph">
<p>The Resource API Endpoints offered by the PEP component are protected based on the unique identifier of the Resource Owner that is adding/removing/editing resources.<br>
The Resource API is protected with OAuth/OIDC in the PEP, expecting any of these tokens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JWT id_tokens: in this case the PEP extracts the necessary claims from the JWT uniquely identifying the user (“sub” parameter)</p>
</li>
<li>
<p>OAuth Access Token: in this case the PEP performs a query against the User-Info endpoint, uniquely identifying the user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The UUID of the End-User will be included as attribute of the Resource description document (extending the data model) upon resource creation (with an “ownership_id” field).<br>
Subsequent requests to the specific Resource ID will perform a JWT or OAuth2.0 check, cross-checking against the “ownership_id” before performing actions and answering back with a 401 Unauthorized if there is no match.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_required_resources">2.3. Required resources</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>List of HW and SW required resources for the correct functioning of the building Block</p>
</li>
<li>
<p>References to open repositories (when applicable)</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_software">2.3.1. Software</h4>
<div class="paragraph">
<p>The following Open-Source Software is required to support the deployment and integration of the Policy Enforcement Point:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EOEPCA&#8217;s SCIM Client - <a href="https://github.com/EOEPCA/um-common-scim-client" class="bare">https://github.com/EOEPCA/um-common-scim-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s UMA Client - <a href="https://github.com/EOEPCA/um-common-uma-client" class="bare">https://github.com/EOEPCA/um-common-uma-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s Well Known Handler - <a href="https://github.com/EOEPCA/well-known-handler" class="bare">https://github.com/EOEPCA/well-known-handler</a></p>
</li>
<li>
<p>Flask - <a href="https://github.com/pallets/flask" class="bare">https://github.com/pallets/flask</a></p>
</li>
<li>
<p>MongoDB for Python - <a href="https://pymongo.readthedocs.io/en/stable/index.html" class="bare">https://pymongo.readthedocs.io/en/stable/index.html</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_static_architecture">2.4. Static Architecture</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Diagram and description of the major logical components within the Building Block</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/static.png" alt="static">
</div>
</div>
<div class="paragraph">
<p>The next section <a href="#mainComponents">Design</a> contains detailed descriptions and references needed to understand the intricacies of this component.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_cases">2.5. Use cases</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Diagrams and definition of the use cases covered by this Building Block</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/PEPFlow2.png" alt="PEPFlow2">
</div>
</div>
<div class="sect3">
<h4 id="_self_authentication_registration">2.5.1. Self Authentication &amp; Registration</h4>
<div class="paragraph">
<p>(Represented in the above graph by the request to Login Service in the section "PEP Authentication" )</p>
</div>
<div class="paragraph">
<p>The PEP has an internal UMA Client used for alll the necessary UMA requests. This client is completely auto-managed even to the point of self-registration, so no pre-configuration is needed in order to run a PEP instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ticket_generation">2.5.2. Ticket generation</h4>
<div class="paragraph">
<p>(Represented in the above graph by the request to Login Service called "Request for ticket")</p>
</div>
<div class="paragraph">
<p>The PEP generates appropiate tickets for access attempts to a resource, which can later be consumed and checked by the Authorization Server in order to give proper clearance to access that same resource.<br>
Ticket generation as per the UMA 2.0 standard, are only valid for that requested it and for that specific resource.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resource_protection_rpt_validation">2.5.3. Resource protection &amp; RPT validation</h4>
<div class="paragraph">
<p>The PEP when presented with an RPT in an <code>Authorization</code> HTTP header, will check the validity of this token for the requested resource. This token is only valid for a limited time, for a specific user, and for a specific resource. This makes attacks via copying an RPT extremely inneficient for an attacker.</p>
</div>
<div class="paragraph">
<p>The PEP will only protect the resources that it recognizes as such. This means that, even without an RPT, the PEP will alllow a client to pass-through directly to the resource server if there is no identified resource that matches what the client is requesting.</p>
</div>
<div class="paragraph">
<p>This behaviour, which is analogous to a blacklist approach (we only deny access a priori of a bunch of resources), can be easily switched to a "whitelist" with simple changes in the code.<br>
On the other hand, this baseline functionality is desirable to allow PEP-chaining, and allows for more complex workflows in the future.</p>
</div>
</div>
<div class="sect3">
<h4 id="_request_forwarding_with_jwt_header">2.5.4. Request Forwarding with JWT header</h4>
<div class="paragraph">
<p>After validating the RPT we proceed to make a call to the introspection endpoint (/oxauth/restv1/rpt/status) passing through parameters the RPT and the pat. Returning a JSON with the information for that token, called claims, where the user name can appear, for example.</p>
</div>
<div class="paragraph">
<p>Then we proceed to generate this JSON to the format of JWT using an asymmetric cryptography, in this case using RSA with a private key. And then pass this JWT as a header in the request to the resource server.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mainComponents">3. Design</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_building_block_design">3.1. Building Block Design</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Content Description</div>
<div class="paragraph">
<p>This section contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A concise breakdown of the Building Block in several independent services (when applicable). For each component, the following subsections are added:</p>
<div class="ulist">
<ul>
<li>
<p>Overview and purpose: indicating the functionality covered by the component</p>
</li>
<li>
<p>SW Reuse and Dependencies: indicating reuse of third party open source solutions (if any) and any pre-required Dependencies</p>
</li>
<li>
<p>Interfaces: both internal to the building block and those exposed externally</p>
</li>
<li>
<p>Data: Data usage of the building block, data flow and any GDPR concerns should be addressed here</p>
</li>
<li>
<p>Applicable Resources: links and references to (Reference Docs), and repositories.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a breakdown is necessary, a general overview of the building block can be given. On the contrary, no breakdown indicates a single component development with the same expected sections.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_reverse_proxy_service">3.2. Reverse Proxy Service</h3>
<div class="sect3">
<h4 id="_overview_and_purpose">3.2.1. Overview and Purpose</h4>
<div class="paragraph">
<p>The Flask-based reverse proxy serves as the interface for input queries. This reverse proxy is in charge of recieving the queries and returning the appropiate HTTP response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_software_reuse_and_dependencies">3.2.2. Software Reuse and Dependencies</h4>
<div class="paragraph">
<p>All requirements for the executing of the reverse proxy are found under src/requirements.txt, and expect Python 3.6.9 or greater to work.</p>
</div>
<div class="paragraph">
<p>The most important are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>EOEPCA-SCIM</strong>: Used to auto-register itself as a client to the Auth. Server upon startup</p>
</li>
<li>
<p><strong>EOEPCA-UMA</strong>: Used as the backbone of the PEP, allows for generation of tickets, verification of RPTs, and any other UMA-related action.</p>
</li>
<li>
<p><strong>EOEPCA-OIDC</strong>: Used to generate PAT tokens, validate OAuth tokens and JWTs.</p>
</li>
<li>
<p><strong>WellKnownHandler</strong>: Used to dynamically check the configuration of the Authorization Server on each execution. For example, it can get the needed endpoints for any API the PEP needs, such as the token request for OIDC.</p>
</li>
<li>
<p><strong>Flask</strong>: External to EOEPCA&#8217;s project, this library allows the PEP to create the actual reverse proxy, sending and recieving custom requests.</p>
</li>
<li>
<p><strong>MongoDB</strong>: Used to store the resources and user identifications</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_interfaces">3.2.3. Interfaces</h4>
<div class="paragraph">
<p>This component doesn&#8217;t have any internal interfaces. For a reference of external interfaces see <a href="#_external_interfaces">External Interfaces</a> on Section 2 <a href="#mainOverview">Overview</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_data">3.2.4. Data</h4>
<div class="sect4">
<h5 id="_configuration">3.2.4.1. Configuration</h5>
<div class="paragraph">
<p>The PEP gets all its configuration from the file located under <code>config/config.json</code>.</p>
</div>
<div class="paragraph">
<p>The parameters that are accepted, and their meaning, are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>realm</strong>: 'realm' parameter answered for each UMA ticket. Default is "eoepca"</p>
</li>
<li>
<p><strong>auth_server_url</strong>: complete url (with "https") of the Authorization server.</p>
</li>
<li>
<p><strong>proxy_endpoint</strong>: "/path"-formatted string to indicate where the reverse proxy should listen. The proxy will catch any request that starts with that path. Default is "/pep"</p>
</li>
<li>
<p><strong>service_host</strong>: Host for the proxy to listen on. For example, "0.0.0.0" will listen on all interfaces</p>
</li>
<li>
<p><strong>service_port</strong>: Port for the proxy to listen on. By default, <strong>5566</strong>. Keep in mind you will have to edit the docker file and/or kubernetes yaml file in order for all the prot forwarding to work.</p>
</li>
<li>
<p><strong>s_margin_rpt_valid</strong>: An integer representing how many seconds of "margin" do we want when checking RPT. For example, using <strong>5</strong> will make sure the provided RPT is valid now AND AT LEAST in the next 5 seconds.</p>
</li>
<li>
<p><strong>check_ssl_certs</strong>: Toggle on/off (bool) to check certificates in all requests. This should be forced to True in a production environment</p>
</li>
<li>
<p><strong>use_threads</strong>: Toggle on/off (bool) the usage of threads for the proxy. Recommended to be left as True.</p>
</li>
<li>
<p><strong>debug_mode</strong>: Toggle on/off (bool) a debug mode of Flask. In a production environment, this should be false.</p>
</li>
<li>
<p><strong>resource_server_endpoint</strong>: Complete url (with "https" and any port) of the Resource Server to protect with this PEP.</p>
</li>
<li>
<p><strong>client_id</strong>: string indicating a client_id for an already registered and configured client. <strong>This parameter is optional</strong>. When not supplied, the PEP will generate a new client for itself and store it in this key inside the JSON.</p>
</li>
<li>
<p><strong>client_secret</strong>: string indicating the client secret for the client_id. <strong>This parameter is optional</strong>. When not supplied, the PEP will generate a new client for itself and store it in this key inside the JSON.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_data_flow">3.2.4.2. Data flow</h5>
<div class="paragraph">
<p>The only information the PEP handles are tickets given by the Auth Server, and RPTs which are sent only to the Auth Server.</p>
</div>
<div class="paragraph">
<p>All data is ephimeral at the time of writting, except the data stored at the config file. The resources are loaded into a mongo database, this allows to store large amounts of resources and more complex queries.</p>
</div>
<div class="paragraph">
<p>What follows is an example of the nominal flow for the PEP, and "ADES" is the Resource Server the PEP is protecting:</p>
</div>
<div class="imageblock text-right">
<div class="content">
<img src="./images/PEPFlow2.png" alt="PEPFlow2">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_extensibility">3.2.5. Extensibility</h4>
<div class="paragraph">
<p>The design of the PEP allows for further improvements if need be. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The resource management in memory could be expanded to a full on DB, by changing how the UMA handler works internally.</p>
</li>
<li>
<p>The UMA library used allows for quick implementations for resource managing, such as creation, deleting and editing.</p>
</li>
<li>
<p>The proxy can be expanded to parse further parameters on top of the HTTP protocol, allowing for any kind of plugin or complex mechanism desired.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_applicable_resources">3.2.6. Applicable Resources</h4>
<div class="ulist">
<ul>
<li>
<p>UMA 2.0 Specification - <a href="https://docs.kantarainitiative.org/uma/wg/rec-oauth-uma-grant-2.0.html" class="bare">https://docs.kantarainitiative.org/uma/wg/rec-oauth-uma-grant-2.0.html</a></p>
</li>
<li>
<p>EOEPCA&#8217;s SCIM Client - <a href="https://github.com/EOEPCA/um-common-scim-client" class="bare">https://github.com/EOEPCA/um-common-scim-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s UMA Client - <a href="https://github.com/EOEPCA/um-common-uma-client" class="bare">https://github.com/EOEPCA/um-common-uma-client</a></p>
</li>
<li>
<p>EOEPCA&#8217;s Well Known Handler - <a href="https://github.com/EOEPCA/well-known-handler" class="bare">https://github.com/EOEPCA/well-known-handler</a></p>
</li>
<li>
<p>Flask - <a href="https://github.com/pallets/flask" class="bare">https://github.com/pallets/flask</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resource_repository">3.3. Resource Repository</h3>
<div class="sect3">
<h4 id="_overview_and_purpose_2">3.3.1. Overview and Purpose</h4>
<div class="paragraph">
<p>It is the database based on MongoDB where the resources are stored and queried for the PEP pourposes</p>
</div>
<div class="paragraph">
<p>Included with the PEP there is a script at the source path that performs queries against a Mongo Database. The main purpose of this script is to reduce the usage of RAM when registering a resource locally and when querying for its content.<br>
It is developed to generate a database called 'resource_db' in case it does not exist. The collection used for the storage of the documents is called 'resources'.<br>
The script defines methods to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Insert resource data</strong>: Generates a document with the resource data received as input and if it already exists, it gets updated. The main parameters of the resource would be an auto-generated id provided by mongo which identify each document in the database, the resource ID provided by the login-service, and the match url which will define the endpoint of the resource. This would be mandatory parameters in order to perform other kind of queries.</p>
</li>
<li>
<p><strong>Get the ID from a URI</strong>: Returns the id for the best candidate of the match by a given URI.</p>
</li>
<li>
<p><strong>Delete resources</strong>: Receives a resource id and will find and delete the matched document</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This script is manipulated by the API which would intercept the request in order to perform PUT,POST and DELETE methods.<br>
The GET method would be called by the reverse proxy since it will be in charge of filtering the resource with the given URI.</p>
</div>
</div>
<div class="sect3">
<h4 id="_data_flow_2">3.3.2. Data flow</h4>
<div class="paragraph">
<p>The database will only be accesible by the API or the Proxy.<br>
The main methods for the interaction with the database are displayed in this dataflow as a summary of its scope:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/MongoFlow.png" alt="MongoFlow">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_applicable_resources_2">3.3.3. Applicable Resources</h4>
<div class="ulist">
<ul>
<li>
<p>MongoDB image from DockerHub - <a href="https://hub.docker.com/_/mongo" class="bare">https://hub.docker.com/_/mongo</a></p>
</li>
</ul>
</div>
<hr>
<div class="paragraph large">
<p>&lt;&lt; End of Document &gt;&gt;</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.1<br>
Last updated 2020-10-30 13:16:05 UTC
</div>
</div>
</body>
</html>